{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kamilkusakov/mydoc/PyDocs/PROJECT/social2.0/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/kamilkusakov/mydoc/PyDocs/PROJECT/social2.0/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import{LOGIN_SUCCESS,LOGIN_FAIL,USER_LOADED_SUCCESS,USER_LOADED_FAIL}from\"./types\";export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var config,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem(\"access\")){_context.next=12;break;}config={headers:{\"Content-Type\":\"application/json\",Authorization:\"JWT \".concat(localStorage.getItem(\"access\")),Accept:\"application/json\"}};_context.prev=2;_context.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/users/me/\"),config);case 5:res=_context.sent;dispatch({type:USER_LOADED_SUCCESS,payload:res.data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);dispatch({type:USER_LOADED_FAIL});case 12:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({email:email,password:password});_context2.prev=2;_context2.next=5;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/jwt/create/\"),body,config);case 5:res=_context2.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);dispatch({type:LOGIN_FAIL});case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};","map":{"version":3,"names":["axios","LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","load_user","dispatch","localStorage","getItem","config","headers","Authorization","Accept","get","process","env","REACT_APP_API_URL","res","type","payload","data","login","email","password","body","JSON","stringify","post"],"sources":["/Users/kamilkusakov/mydoc/PyDocs/PROJECT/social2.0/frontend/src/actions/auth.js"],"sourcesContent":["import axios from \"axios\";\nimport {\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  USER_LOADED_SUCCESS,\n  USER_LOADED_FAIL,\n} from \"./types\";\n\nexport const load_user = () => async (dispatch) => {\n    // access token in local storage\n  if (localStorage.getItem(\"access\")) {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `JWT ${localStorage.getItem(\"access\")}`,\n        Accept: \"application/json\",\n      },\n    };\n\n    try {\n        const res = await axios.get(\n          `${process.env.REACT_APP_API_URL}/api/auth/users/me/`,\n          config\n        );\n    \n        dispatch({\n          type: USER_LOADED_SUCCESS,\n          payload: res.data,\n        });\n      } catch (err) {\n        dispatch({\n          type: USER_LOADED_FAIL,\n        });\n      }\n  }\n};\n\nexport const login = (email, password) => async (dispatch) => {\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  };\n\n  const body = JSON.stringify({ email, password });\n\n  try {\n    const res = await axios.post(\n      `${process.env.REACT_APP_API_URL}/api/auth/jwt/create/`,\n      body,\n      config\n    );\n\n    dispatch({\n      type: LOGIN_SUCCESS,\n      payload: res.data,\n    });\n  } catch (err) {\n    dispatch({\n      type: LOGIN_FAIL,\n    });\n  }\n};\n"],"mappings":"kTAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OACEC,aAAa,CACbC,UAAU,CACVC,mBAAmB,CACnBC,gBAAgB,KACX,SAAS,CAEhB,MAAO,IAAMC,UAAS,CAAG,QAAZA,UAAS,oGAAS,iBAAOC,QAAQ,uIAExCC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,0BAC1BC,MAAM,CAAG,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,eAASJ,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAE,CACtDI,MAAM,CAAE,kBACV,CACF,CAAC,uCAGqBZ,MAAK,CAACa,GAAG,WACtBC,OAAO,CAACC,GAAG,CAACC,iBAAiB,wBAChCP,MAAM,CACP,QAHKQ,GAAG,eAKTX,QAAQ,CAAC,CACPY,IAAI,CAAEf,mBAAmB,CACzBgB,OAAO,CAAEF,GAAG,CAACG,IACf,CAAC,CAAC,CAAC,+EAEHd,QAAQ,CAAC,CACPY,IAAI,CAAEd,gBACR,CAAC,CAAC,CAAC,oEAGV,iEAED,MAAO,IAAMiB,MAAK,CAAG,QAARA,MAAK,CAAIC,KAAK,CAAEC,QAAQ,oGAAK,kBAAOjB,QAAQ,4IACjDG,MAAM,CAAG,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAEKc,IAAI,CAAGC,IAAI,CAACC,SAAS,CAAC,CAAEJ,KAAK,CAALA,KAAK,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAAC,yCAG5BvB,MAAK,CAAC2B,IAAI,WACvBb,OAAO,CAACC,GAAG,CAACC,iBAAiB,0BAChCQ,IAAI,CACJf,MAAM,CACP,QAJKQ,GAAG,gBAMTX,QAAQ,CAAC,CACPY,IAAI,CAAEjB,aAAa,CACnBkB,OAAO,CAAEF,GAAG,CAACG,IACf,CAAC,CAAC,CAAC,mFAEHd,QAAQ,CAAC,CACPY,IAAI,CAAEhB,UACR,CAAC,CAAC,CAAC,sEAEN"},"metadata":{},"sourceType":"module","externalDependencies":[]}